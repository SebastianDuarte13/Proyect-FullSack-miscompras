<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Entidades</title>
    <style>
        body {
            
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .menu {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .menu button, .submenu button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        .section, .subsection {
            display: none;
            margin-bottom: 20px;
        }
        .submenu {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        form {
            margin-bottom: 20px;
        }
        label, input, button {
            margin-bottom: 10px;
            display: block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }

        
    </style>
</head>
<body>
    <h1>Gestión de Entidades</h1>

    <div class="menu">
        <button onclick="showSection('category')">Categorías</button>
        <button onclick="showSection('customers')">Clientes</button>
        <button onclick="showSection('productos')">Productos</button>
        <button onclick="showSection('shopping')">Compras</button>
        <button onclick="showSection('shoppingProducts')">Productos de Compra</button>
    </div>

    <div id="category" class="section">
        <h2>Gestión de Categorías</h2>
        <div class="submenu">
            <button onclick="showSubsection('category', 'add')">Añadir</button>
            <button onclick="showSubsection('category', 'find')">Buscar</button>
            <button onclick="showSubsection('category', 'update')">Actualizar</button>
            <button onclick="showSubsection('category', 'delete')">Eliminar</button>
        </div>
        <div id="categoryAdd" class="subsection">
            <h3>Añadir Categoría</h3>
            <form id="categoryAddForm">
                <label for="categoryDescripcion">Descripción:</label>
                <input type="text" id="categoryDescripcion" name="descripcion" required>
                <label for="categoryEstado">Estado:</label>
                <input type="number" id="categoryEstado" name="estado" required min="0" max="9">
                <button type="submit">Guardar</button>
            </form>
        </div>
        <div id="categoryFind" class="subsection">
            <h3>Buscar Categorías</h3>
            <button onclick="findAll('category')">Mostrar Todas las Categorías</button>
            <div id="categoryList"></div>
        </div>
        <div id="categoryUpdate" class="subsection">
            <h3>Actualizar Categoría</h3>
            <form id="categoryUpdateForm">
                <label for="categoryUpdateId">ID:</label>
                <input type="number" id="categoryUpdateId" name="id" required>
                <label for="categoryUpdateDescripcion">Descripción:</label>
                <input type="text" id="categoryUpdateDescripcion" name="descripcion" required>
                <label for="categoryUpdateEstado">Estado:</label>
                <input type="number" id="categoryUpdateEstado" name="estado" required min="0" max="9">
                <button type="submit">Actualizar</button>
            </form>
        </div>
        <div id="categoryDelete" class="subsection">
            <h3>Eliminar Categoría</h3>
            <form id="categoryDeleteForm">
                <label for="categoryDeleteId">ID de la categoría a eliminar:</label>
                <input type="number" id="categoryDeleteId" name="id" required>
                <button type="submit">Eliminar</button>
            </form>
        </div>
    </div>

    <div id="customers" class="section">
        <h2>Gestión de Clientes</h2>
        <div class="submenu">
            <button onclick="showSubsection('customers', 'add')">Añadir</button>
            <button onclick="showSubsection('customers', 'find')">Buscar</button>
            <button onclick="showSubsection('customers', 'update')">Actualizar</button>
            <button onclick="showSubsection('customers', 'delete')">Eliminar</button>
        </div>
        <div id="customersAdd" class="subsection">
            <h3>Añadir Cliente</h3>
            <form id="customersAddForm">
                <label for="customerNombre">Nombre:</label>
                <input type="text" id="customerNombre" name="nombre" required>
                <label for="customerApellidos">Apellidos:</label>
                <input type="text" id="customerApellidos" name="apellidos" required>
                <label for="customerCelular">Celular:</label>
                <input type="number" id="customerCelular" name="celular" required>
                <label for="customerDireccion">Dirección:</label>
                <input type="text" id="customerDireccion" name="direccion" required>
                <label for="customerCorreo">Correo Electrónico:</label>
                <input type="email" id="customerCorreo" name="correo_electronico" required>
                <button type="submit">Guardar</button>
            </form>
        </div>
        <div id="customersFind" class="subsection">
            <h3>Buscar Clientes</h3>
            <button onclick="findAll('customers')">Mostrar Todos los Clientes</button>
            <div id="customersList"></div>
        </div>
        <div id="customersUpdate" class="subsection">
            <h3>Actualizar Cliente</h3>
            <form id="customersUpdateForm">
                <label for="customerUpdateId">ID:</label>
                <input type="number" id="customerUpdateId" name="id" required>
                <label for="customerUpdateNombre">Nombre:</label>
                <input type="text" id="customerUpdateNombre" name="nombre" required>
                <label for="customerUpdateApellidos">Apellidos:</label>
                <input type="text" id="customerUpdateApellidos" name="apellidos" required>
                <label for="customerUpdateCelular">Celular:</label>
                <input type="number" id="customerUpdateCelular" name="celular" required>
                <label for="customerUpdateDireccion">Dirección:</label>
                <input type="text" id="customerUpdateDireccion" name="direccion" required>
                <label for="customerUpdateCorreo">Correo Electrónico:</label>
                <input type="email" id="customerUpdateCorreo" name="correo_electronico" required>
                <button type="submit">Actualizar</button>
            </form>
        </div>
        <div id="customersDelete" class="subsection">
            <h3>Eliminar Cliente</h3>
            <form id="customersDeleteForm">
                <label for="customerDeleteId">ID del cliente a eliminar:</label>
                <input type="number" id="customerDeleteId" name="id" required>
                <button type="submit">Eliminar</button>
            </form>
        </div>
    </div>

    <div id="productos" class="section">
        <h2>Gestión de Productos</h2>
        <div class="submenu">
            <button onclick="showSubsection('productos', 'add')">Añadir</button>
            <button onclick="showSubsection('productos', 'find')">Buscar</button>
            <button onclick="showSubsection('productos', 'update')">Actualizar</button>
            <button onclick="showSubsection('productos', 'delete')">Eliminar</button>
        </div>
        <div id="productosAdd" class="subsection">
            <h3>Añadir Producto</h3>
            <form id="productosAddForm">
                <label for="productoNombre">Nombre:</label>
                <input type="text" id="productoNombre" name="nombre" required>
                <label for="productoIdCategoria">ID Categoría:</label>
                <input type="number" id="productoIdCategoria" name="id_categoria" required>
                <label for="productoCodigoBarras">Código de Barras:</label>
                <input type="text" id="productoCodigoBarras" name="codigo_barras" required>
                <label for="productoPrecioVenta">Precio de Venta:</label>
                <input type="number" id="productoPrecioVenta" name="precio_venta" required>
                <label for="productoCantidadStock">Cantidad en Stock:</label>
                <input type="number" id="productoCantidadStock" name="cantidad_stock" required>
                <label for="productoEstado">Estado:</label>
                <input type="number" id="productoEstado" name="estado" required min="0" max="1">
                <button type="submit">Guardar</button>
            </form>
        </div>
        <div id="productosFind" class="subsection">
            <h3>Buscar Productos</h3>
            <button onclick="findAll('productos')">Mostrar Todos los Productos</button>
            <div id="productosList"></div>
        </div>
        <div id="productosUpdate" class="subsection">
            <h3>Actualizar Producto</h3>
            <form id="productosUpdateForm">
                <label for="productoUpdateId">ID:</label>
                <input type="number" id="productoUpdateId" name="id_producto" required>
                <label for="productoUpdateNombre">Nombre:</label>
                <input type="text" id="productoUpdateNombre" name="nombre" required>
                <label for="productoUpdateIdCategoria">ID Categoría:</label>
                <input type="number" id="productoUpdateIdCategoria" name="id_categoria" required>
                <label for="productoUpdateCodigoBarras">Código de Barras:</label>
                <input type="text" id="productoUpdateCodigoBarras" name="codigo_barras" required>
                <label for="productoUpdatePrecioVenta">Precio de Venta:</label>
                <input type="number" id="productoUpdatePrecioVenta" name="precio_venta" required>
                <label for="productoUpdateCantidadStock">Cantidad en Stock:</label>
                <input type="number" id="productoUpdateCantidadStock" name="cantidad_stock" required>
                <label for="productoUpdateEstado">Estado:</label>
                <input type="number" id="productoUpdateEstado" name="estado" required min="0" max="1">
                <button type="submit">Actualizar</button>
            </form>
        </div>
        <div id="productosDelete" class="subsection">
            <h3>Eliminar Producto</h3>
            <form id="productosDeleteForm">
                <label for="productoDeleteId">ID del producto a eliminar:</label>
                <input type="number" id="productoDeleteId" name="id_producto" required>
                <button type="submit">Eliminar</button>
            </form>
        </div>
    </div>

    <div id="shopping" class="section">
        <h2>Gestión de Compras</h2>
        <div class="submenu">
            <button onclick="showSubsection('shopping', 'add')">Añadir</button>
            <button onclick="showSubsection('shopping', 'find')">Buscar</button>
            <button onclick="showSubsection('shopping', 'update')">Actualizar</button>
            <button onclick="showSubsection('shopping', 'delete')">Eliminar</button>
        </div>
        <div id="shoppingAdd" class="subsection">
            <h3>Añadir Compra</h3>
            <form id="shoppingAddForm">
                <label for="shoppingFecha">Fecha:</label>
                <input type="date" id="shoppingFecha" name="fecha" required>
                <label for="shoppingMedioPago">Medio de Pago:</label>
                <input type="number" id="shoppingMedioPago" name="medioPago" required min="0" max="9">
                <label for="shoppingComentario">Comentario:</label>
                <input type="text" id="shoppingComentario" name="comentario">
                <label for="shoppingEstado">Estado:</label>
                <input type="number" id="shoppingEstado" name="estado" required min="0" max="9">
                <label for="shoppingIdCliente">ID Cliente:</label>
                <input type="number" id="shoppingIdCliente" name="customer.id" required>
                <button type="submit">Guardar</button>
            </form>
        </div>
        <div id="shoppingFind" class="subsection">
            <h3>Buscar Compras</h3>
            <button onclick="findAll('shopping')">Mostrar Todas las Compras</button>
            <div id="shoppingList"></div>
        </div>
        <div id="shoppingUpdate" class="subsection">
            <h3>Actualizar Compra</h3>
            <form id="shoppingUpdateForm">
                <label for="shoppingUpdateId">ID:</label>
                <input type="number" id="shoppingUpdateId" name="id" required>
                <label for="shoppingUpdateFecha">Fecha:</label>
                <input type="date" id="shoppingUpdateFecha" name="fecha" required>
                <label for="shoppingUpdateMedioPago">Medio de Pago:</label>
                <input type="number" id="shoppingUpdateMedioPago" name="medioPago" required min="0" max="9">
                <label for="shoppingUpdateComentario">Comentario:</label>
                <input type="text" id="shoppingUpdateComentario" name="comentario">
                <label for="shoppingUpdateEstado">Estado:</label>
                <input type="number" id="shoppingUpdateEstado" name="estado" required min="0" max="9">
                <label for="shoppingUpdateIdCliente">ID Cliente:</label>
                <input type="number" id="shoppingUpdateIdCliente" name="customer.id" required>
                <button type="submit">Actualizar</button>
            </form>
        </div>
        <div id="shopping Delete" class="subsection">
            <h3>Eliminar Compra</h3>
            <form id="shoppingDeleteForm">
                <label for="shoppingDeleteId">ID de la compra a eliminar:</label>
                <input type="number" id="shoppingDeleteId" name="id" required>
                <button type="submit">Eliminar</button>
            </form>
        </div>
    </div>

    <div id="shoppingProducts" class="section">
        <h2>Gestión de Productos de Compra</h2>
        <div class="submenu">
            <button onclick="showSubsection('shoppingProducts', 'add')">Añadir</button>
            <button onclick="showSubsection('shoppingProducts', 'find')">Buscar</button>
            
        </div>
        <div id="shoppingProductsAdd" class="subsection">
            <h3>Añadir Producto de Compra</h3>
            <form id="shoppingProductsAddForm">
                <label for="shoppingProductsIdShopping">ID Compra:</label>
                <input type="number" id="shoppingProductsIdShopping" name="id.idShopping" required>
                <label for="shoppingProductsIdProduct">ID Producto:</label>
                <input type="number" id="shoppingProductsIdProduct" name="id.idProduct" required>
                <label for="shoppingProductsCantidad">Cantidad:</label>
                <input type="number" id="shoppingProductsCantidad" name="cantidad" required>
                <label for="shoppingProductsTotal">Total:</label>
                <input type="number" id="shoppingProductsTotal" name="total" required>
                <label for="shoppingProductsEstado">Estado:</label>
                <input type="number" id="shoppingProductsEstado" name="estado" required min="0" max="1">
                <button type="submit">Guardar</button>
            </form>
        </div>
        <div id="shoppingProductsFind" class="subsection">
            <h3>Buscar Productos de Compra</h3>
            <button onclick="findAll('shoppingProducts')">Mostrar Todos los Productos de Compra</button>
            <div id="shoppingProductsList"></div>
        </div>
    </div>
    
    <script>
        const API_URL = 'http://localhost:8080/api';

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.style.display = section.id === sectionId ? 'block' : 'none';
            });
        }

        function showSubsection(sectionId, subsectionId) {
            const subsections = document.querySelectorAll(`#${sectionId} .subsection`);
            subsections.forEach(subsection => {
                subsection.style.display = subsection.id === `${sectionId}${subsectionId.charAt(0).toUpperCase() + subsectionId.slice(1)}` ? 'block' : 'none';
            });
        }

        function handleSubmit(event, entityType, action) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            let url = `${API_URL}/${entityType}`;
            let method = 'POST';

            if (action === 'update') {
                url += `/${data.id}`;
                method = 'PUT';
            } else if (action === 'delete') {
                url += `/${data.id}`;
                method = 'DELETE';
            }

            fetch(url, {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                console.log(`${entityType} ${action}:`, result);
                alert(`${entityType} ${action === 'add' ? 'añadido' : action === 'update' ? 'actualizado' : 'eliminado'} con éxito`);
                form.reset();
                if (action === 'add' || action === 'update' || action === 'delete') {
                    findAll(entityType);
                }
            })
            .catch(error => {
                console.error(`Error ${action} ${entityType}:`, error);
                alert(`Error al ${action === 'add' ? 'añadir' : action === 'update' ? 'actualizar' : 'eliminar'} ${entityType}`);
            });
        }

        function findAll(entityType) {
            fetch(`${API_URL}/${entityType}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    const listElement = document.getElementById(`${entityType}List`);
                    listElement.innerHTML = '';
                    if (data.length === 0) {
                        listElement.innerHTML = 'No hay datos disponibles.';
                        return;
                    }
                    const table = document.createElement('table');
                    const headers = Object.keys(data[0]);
                    
                    const headerRow = table.insertRow();
                    headers.forEach(header => {
                        const th = document.createElement('th');
                        th.textContent = header;
                        headerRow.appendChild(th);
                    });

                    data.forEach(item => {
                        const row = table.insertRow();
                        headers.forEach(header => {
                            const cell = row.insertCell();
                            cell.textContent = item[header] !== null && typeof item[header] === 'object' 
                                ? JSON.stringify(item[header]) 
                                : item[header];
                        });
                    });

                    listElement.appendChild(table);
                })
                .catch(error => {
                    console.error(`Error fetching ${entityType}:`, error);
                    const listElement = document.getElementById(`${entityType}List`);
                    listElement.innerHTML = `Error al cargar los datos: ${error.message}`;
                });
        }

        // Event listeners for forms
        document.getElementById('categoryAddForm').addEventListener('submit', (e) => handleSubmit(e, 'category', 'add'));
        document.getElementById('categoryUpdateForm').addEventListener('submit', (e) => handleSubmit(e, 'category', 'update'));
        document.getElementById('categoryDeleteForm').addEventListener('submit', (e) => handleSubmit(e, 'category', 'delete'));

        document.getElementById('customersAddForm').addEventListener('submit', (e) => handleSubmit(e, 'customers', 'add'));
        document.getElementById('customersUpdateForm').addEventListener('submit', (e) => handleSubmit(e, 'customers', 'update'));
        document.getElementById('customersDeleteForm').addEventListener('submit', (e) => handleSubmit(e, 'customers', 'delete'));

        document.getElementById('productosAddForm').addEventListener('submit', (e) => handleSubmit(e, 'productos', 'add'));
        document.getElementById('productosUpdateForm').addEventListener('submit', (e) => handleSubmit(e, 'productos', 'update'));
        document.getElementById('productosDeleteForm').addEventListener('submit', (e) => handleSubmit(e, 'productos', 'delete'));

        document.getElementById('shoppingAddForm').addEventListener('submit', (e) => handleSubmit(e, 'shopping', 'add'));
        document.getElementById('shoppingUpdateForm').addEventListener('submit', (e) => handleSubmit(e, 'shopping', 'update'));
        document.getElementById('shoppingDeleteForm').addEventListener('submit', (e) => handleSubmit(e, 'shopping', 'delete'));

        document.getElementById('shoppingProductsAddForm').addEventListener('submit', (e) => handleSubmit(e, 'shoppingProducts', 'add'));
    </script>
</body>
</html>